<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Find This Film</title>
    <!-- Include Bulma CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
    <!-- Include Bulma Carousel -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-carousel@4.0.3/dist/css/bulma-carousel.min.css">
    <!-- Custom CSS -->
    <style>
      .is-fullheight-100vh {
        height: 100vh;
      }
      .carousel {
        overflow: hidden;
      }
      .poster-item {
        position: relative;
      }

      /* Overlay style*/
      .poster-item::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      /* Text style */
      .poster-item span {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 14px;
        font-weight: bold;
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      
      /* Show overlay and text on hover */
      .poster-item:hover::before, .poster-item:hover span {
        opacity: 1;
        cursor: pointer;
        z-index: 1;
      }
      .poster-item figure {
        padding: 0 3rem;
      }
    </style>
  </head>
  <body class="columns is-flex-direction-column is-fullheight-100vh">
    <!-- Toast notification -->
    <div
      id="toast"
      style="position: fixed; top: 10px; right: 10px; z-index: 1000"
      class="notification is-success is-light is-hidden"
    >
      Copied to clipboard
    </div>

    <div
      id="toast2"
      style="position: fixed; top: 10px; right: 10px; z-index: 1000"
      class="notification is-danger is-light is-hidden"
    >
      Could not copy the content
    </div>

    <header class="column is-narrow">
      <section class="section">
        <h1 class="title">Find This Film</h1>
        <h2 class="subtitle">
          This project leverages the themoviedb.org API to retrieve comprehensive
          movie details, simplifying access to film information by
          <strong>title and release year</strong>.
        </h2>
      </section>
    </header>
    <section class="column section">
      <div class="container">
        <div class="card">
          <div class="card-content">
            <form method="POST" action="/results">
              <div class="field is-horizontal">
                <div class="field-body">
                  <div class="field">
                    <!-- <label for="film_name">Film Name:</label> -->
                    <div class="control">
                      <input
                        class="input is-normal"
                        type="text"
                        name="film_name"
                        placeholder="Film Name*"
                        required
                      />
                    </div>
                  </div>
                  <div class="field">
                    <!-- <label for="year_of_release">Year of Release:</label> -->
                    <div class="control">
                      <input
                        class="input is-normal"
                        type="text"
                        name="year_of_release"
                        placeholder="Year of Release"
                      />
                    </div>
                  </div>
                  <div class="field">
                    <div class="control">
                      <button class="button is-primary" type="submit">
                        Get Details
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <section class="column section">
      {% for result in results %} {% if 'error' in result %}
        <div class="container">
          <div class="card">
            <div class="card-content">
              <div class="columns">
                <div class="column">
                  <h3 class="title is-3">No Results Found</h3>
                  <p>
                    Sorry, no movie details were found for the provided film title
                    and release year.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      {% else %}
        <div class="card">
          <div class="card-content">
            <div class="columns">
              <div class="column is-one-quarter">
                <div class="container is-clipped">
                  <div id="poster-carousel" class="carousel">
                    {% for poster_url in result.poster_paths %}
                    <div class="poster-item" onclick="copyToClipboard('{{poster_url}}')">
                      <span>Click to copy</span>
                      <figure class="image is-256x256">
                        <img src="{{poster_url}}" alt="{{result.title}}" />
                      </figure>
                    </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
              <div class="column">
                <p>
                  <strong>Title:</strong>
                  {{result.title}}
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.title}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <strong>Year of Release:</strong>
                  {{result.year_of_release}}
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.year_of_release}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <strong>Director:</strong>
                  {{result.director}}
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.director}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <strong>Countries:</strong>
                  {{result.countries}}
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.countries}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <strong>Language:</strong>
                  {{result.language}}
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.language}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <strong>Runtime:</strong>
                  {{result.runtime}}
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.runtime}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <strong>Genres:</strong>
                  {{result.genres}}
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.genres}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <strong>Overview:</strong> {{result.overview}}
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.overview}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <a href="{{result.tmdb_url}}">TMDB</a>
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.tmdb_url}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <a href="{{result.lb_url}}">Letterboxd</a>
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.lb_url}}')"
                  >
                    Copy
                  </button>
                </p>
                <p>
                  <a href="{{result.imdb_url}}">IMDB</a>
                  <button
                    class="button is-small is-responsive is-light ml-2"
                    onclick="copyToClipboard('{{result.imdb_url}}')"
                  >
                    Copy
                  </button>
                </p>
              </div>
            </div>
          </div>
        </div>
      {% endif %} {% endfor %}
    </section>

    <footer class="column is-narrow footer">
      <div class="content has-text-centered">
        <p>
          Data provided by <a href="https://www.themoviedb.org/">TMDB</a>. Built
          with <a href="https://flask.palletsprojects.com/en/3.0.x/">Flask</a>.
          Styled with <a href="https://bulma.io/">Bulma</a>. Hosted on
          <a href="https://vercel.com/">Vercel</a>.
        </p>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bulma-carousel@4.0.3/dist/js/bulma-carousel.min.js"></script>

    <script>
      function copyToClipboard(text) {
        navigator.clipboard
          .writeText(text)
          .then(function () {
            // Show the toast notification
            const toast = document.getElementById("toast");
            toast.classList.remove("is-hidden");
            setTimeout(function () {
              toast.classList.add("is-hidden");
            }, 1000);
          })
          .catch(function (err) {
            const toast = document.getElementById("toast2");
            toast.classList.remove("is-hidden");
            setTimeout(function () {
              toast.classList.add("is-hidden");
            }, 1000);
          });
      }

      bulmaCarousel.attach('#poster-carousel', {
        slidesToScroll: 1,
        slidesToShow: 1,
        autoplay: true,
        autoplaySpeed: 3000,  
        pauseOnHover: true,
        navigation: true,
        pagination: false
      });
    </script>
  </body>
</html>